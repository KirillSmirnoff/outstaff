-- liquibase formatted sql

-- changeset k2:1674136907759-1
CREATE TABLE "public"."companies"
(
    "n_id"           INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    "c_company_name" VARCHAR(100)                             NOT NULL,
    "c_additonal"    VARCHAR(100),
    CONSTRAINT "companies_pkey" PRIMARY KEY ("n_id")
);

-- changeset k2:1674136907759-2
CREATE TABLE "public"."workers"
(
    "n_id"         BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    "n_name"       VARCHAR(200)                            NOT NULL,
    "d_birthday"   date                                    NOT NULL,
    "c_phone"      VARCHAR(15)                             NOT NULL,
    "c_mail"       VARCHAR(100),
    "n_type"       VARCHAR(100),
    "n_company_id" INTEGER,
    "b_status"     BOOLEAN DEFAULT TRUE,
    CONSTRAINT "workers_pkey" PRIMARY KEY ("n_id")
);

-- changeset k2:1674136907759-3
CREATE TABLE "public"."users"
(
    "n_id"       BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    "c_username" VARCHAR(100)                            NOT NULL,
    "c_login"    VARCHAR(100)                            NOT NULL,
    "c_password" VARCHAR(200)                            NOT NULL,
    "c_phone"    VARCHAR(20),
    "c_mail"     VARCHAR(100),
    CONSTRAINT "users_pkey" PRIMARY KEY ("n_id")
);

-- changeset k2:1674136907759-4
CREATE TABLE "public"."roles"
(
    "n_id"        BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    "c_role_name" VARCHAR(50)                             NOT NULL,
    "d_date"      TIMESTAMP WITHOUT TIME ZONE DEFAULT NOW(),
    "c_comment"   VARCHAR(200),
    "n_delete"    SMALLINT                    DEFAULT 0   NOT NULL,
    CONSTRAINT "roles_pkey" PRIMARY KEY ("n_id")
);

-- changeset k2:1674136907759-5
CREATE TABLE "public"."users_roles"
(
    "n_id"      BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    "n_user_id" INTEGER,
    "n_role_id" INTEGER,
    CONSTRAINT "users_roles_pkey" PRIMARY KEY ("n_id")
);

-- changeset k2:1674136907759-6
ALTER TABLE "public"."users_roles"
    ADD CONSTRAINT "users_roles_n_role_id_fkey" FOREIGN KEY ("n_role_id") REFERENCES "public"."roles" ("n_id") ON UPDATE NO ACTION ON DELETE NO ACTION;

-- changeset k2:1674136907759-7
ALTER TABLE "public"."users_roles"
    ADD CONSTRAINT "users_roles_n_user_id_fkey" FOREIGN KEY ("n_user_id") REFERENCES "public"."users" ("n_id") ON UPDATE NO ACTION ON DELETE NO ACTION;

-- changeset k2:1674136907759-8
ALTER TABLE "public"."workers"
    ADD CONSTRAINT "workers_n_company_id_fkey" FOREIGN KEY ("n_company_id") REFERENCES "public"."companies" ("n_id") ON UPDATE NO ACTION ON DELETE NO ACTION;

